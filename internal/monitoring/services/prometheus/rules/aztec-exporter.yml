groups:
  - name: aztec-exporter
    rules:
      - alert: AztecExporterDown
        expr: up{instance_id="sedge_aztec_exporter"} == 0
        for: 2m
        labels:
          severity: critical
        annotations:
          summary: "Aztec exporter (OTel collector) is down"
          description: "Prometheus cannot scrape the Aztec exporter (OpenTelemetry Collector)."
      - alert: L2BlockHeightNotIncreasing
        expr: increase(aztec_archiver_block_height{aztec_status=""}[15m]) == 0
        for: 5m
        labels:
        severity: critical
        annotations:
        summary: "Node not processing L2 blocks"
        description: "No L2 blocks processed in the last 15 minutes. Node may be stuck or out of sync."
      - alert: LowPeerCount
        expr: aztec_peer_manager_peer_count_peers < 5
        for: 10m
        labels:
          severity: warning
        annotations:
          summary: "Low peer count detected"
          description: "Node has only {{ $value }} peers connected. Risk of network isolation."
      - alert: L1BlockHeightNotIncreasing
        expr: increase(aztec_l1_block_height[15m]) == 0
        for: 10m
        labels:
          severity: warning
        annotations:
          summary: "Node not seeing new L1 blocks"
          description: "No L1 block updates in 15 minutes. Check node and L1 RPC connection."
